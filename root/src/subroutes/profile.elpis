
@ClientSide
define function updateState with params stateKey, stateValue
  setState(stateKey: stateKey, stateValue: stateValue)

@ClientSide
define function loadProfile
  runJS(jsCode: "
    if (page.canTransit) {
      page.canTransit = false;
      let savedOverflow = page.document.getElementById('profileContainer').style.overflow;
      page.document.getElementById('profileContainer').style.overflow = 'hidden';
      page.setState({...page.state, profileAppBarAnim: 'fadeInDownBig', profileHistListAnim: 'fadeInUpBig'
        , profileAppBarAnimTime: '1s', profileHistListAnimTime: '1s'
        , profileFabAnim: 'zoomIn', profileFabAnimTime: '1s'
        , homeAppBarAnim: 'fadeOutUpBig', homeBottomBarAnim: 'fadeOutDownBig'
        , homeFabAnim: 'zoomOut', homeFabAnimTime: '1s'
        , homeAppBarAnimTime: '1s', homeBottomBarAnimTime: '1s'
      });
      setTimeout(() => {
        page.setStyle('homeContainer', 'display', 'none');
        page.setState({...page.state, profileAppBarAnim: '', profileHistListAnim: '', profileFabAnim: ''
          , homeFabAnim: 'zoomOut'
          , homeAppBarAnim: '', homeBottomBarAnim: ''});
        page.document.getElementById('profileContainer').style.overflow = savedOverflow;
        page.document.documentElement.style.overflow = page.documentElementOverflow;
        setTimeout(() => {page.canTransit = true;}, 250);
      }, 1100);
      page.document.getElementById('profileContainer').style.display = 'block';
    }
  ")

@ClientSide
define function hideProfileAndShowUserInfo
  runJS(jsCode: "
    if (page.canTransit) {
      page.canTransit = false;
      let savedOverflow = page.document.getElementById('profileContainer').style.overflow;
      page.setState({...page.state, profileAppBarAnim: 'fadeOutUpBig', profileHistListAnim: 'fadeOutDownBig'
        , profileAppBarAnimTime: '2s', profileHistListAnimTime: '2s'
        , profileFabAnim: 'zoomOut', profileFabAnimTime: '2s'
        , userInfoAppBarAnim: 'fadeInDownBig', userInfoFormAnim: 'fadeInUpBig'
        , userInfoAppBarAnimTime: '1s', userInfoFormAnimTime: '1s'
      });
      page.document.getElementById('profileContainer').style.overflow = 'hidden';
      page.document.getElementById('userInfoContainer').style.display = 'block';
      setTimeout(() => {
        page.setState({...page.state, profileAppBarAnim: '', profileHistListAnim: '', profileFabAnim: ''
          , userInfoAppBarAnim: '', userInfoFormAnim: ''});
        page.document.getElementById('profileContainer').style.overflow = savedOverflow;
        page.setStyle('profileContainer', 'display', 'none');
        setTimeout(() => {page.canTransit = true;}, 250);
      }, 1100);
    }
  ")

@ClientSide
define function hideProfile
  runJS(jsCode: "
    if (page.canTransit) {
      page.canTransit = false;
      let savedOverflow = page.document.getElementById('profileContainer').style.overflow;
      page.setState({...page.state, profileAppBarAnim: 'fadeOutUpBig', profileHistListAnim: 'fadeOutDownBig'
        , profileAppBarAnimTime: '2s', profileHistListAnimTime: '2s'
        , profileFabAnim: 'zoomOut', profileFabAnimTime: '2s'
        , homeFabAnim: 'zoomIn', homeFabAnimTime: '1s'
        , homeAppBarAnim: 'fadeInDownBig', homeBottomBarAnim: 'fadeInUpBig'
        , homeAppBarAnimTime: '1s', homeBottomBarAnimTime: '1s'
      });
      page.document.documentElement.style.overflow = 'hidden';
      page.document.getElementById('profileContainer').style.overflow = 'hidden';
      page.setStyle('homeContainer', 'display', 'block');
      setTimeout(() => {
        page.setState({...page.state, profileAppBarAnim: '', profileHistListAnim: '', profileFabAnim: ''
          , homeFabAnim: ''
          , homeItemAnim: 'zoomIn'
          , homeAppBarAnim: '', homeBottomBarAnim: ''});
        page.document.getElementById('profileContainer').style.overflow = savedOverflow;
        page.setStyle('profileContainer', 'display', 'none');
        setTimeout(() => {
          page.setState({...page.state, homeItemAnim: ''});
          setTimeout(() => {page.canTransit = true;}, 250);
        }, 1100);
      }, 1100);
    }
  ")

histItem = ({
              controlType: "div",
              children: [
            {
              controlType: "ListItem",
              children: [
                {
                  controlType: "ListItemAvatar",
                  children: [
                    {
                      controlType: "Avatar",
                      children: [
                        {
                          controlType: "FolderIcon"
                        }
                      ]
                    }
                  ]
                },
                {
                  controlType: "ListItemText",
                  properties: {
                    primary: "روز اول"
                  },
                  style: {
                    width: 200,
                    textAlign: "right",
                    marginRight: 16,
                    marginLeft: 16
                  }
                },
                {
                  controlType: "div",
                  children: [
                    {
                      controlType: "IconButton",
                      children: [
                        {
                          controlType: "DeleteIcon"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              controlType: "Divider",
              properties: {
                component: "li"
              }
            }
          ]
        })

profilePage = (
      {
        controlType: "Box",
        properties: {
          id: "profileContainer"
        },
        style: {
          width: "100%",
          height: "100%",
          direction: "rtl",
          position: "absolute",
          left: 0,
          top: 0,
          display: "none"
        },
        children: [
          {
            controlType: "AppBar",
            properties: {
              id: "profileAppBar",
              animation: "${profileAppBarAnim}",
              animationTime: "${profileAppBarAnimTime}",
              hideOnScroll: true,
              color: "#07d"
            },
            style: {
              height: 256
            },
            children: [
              {
                controlType: "div",
                style: {
                  width: "100%"
                },
                children: [
                  {
                    controlType: "IconButton",
                    properties: {
                      onClick: "${() => page.hideProfileAndShowUserInfo()}"
                    },
                    style: {
                      marginLeft: 16,
                      marginTop: 16,
                      marginRight: 16,
                      position: "absolute",
                      right: 0
                    },
                    children: [
                      {
                        controlType: "InfoOutlinedIcon",
                        style: {
                          fill: "#fff"
                        }
                      }
                    ]
                  },
                  {
                    controlType: "IconButton",
                    properties: {
                      onClick: "${() => page.hideProfile()}"
                    },
                    style: {
                      marginLeft: 16,
                      marginTop: 16,
                      marginRight: 16,
                      position: "absolute",
                      left: 0
                    },
                    children: [
                      {
                        controlType: "CloseIcon",
                        style: {
                          fill: "#fff"
                        }
                      }
                    ]
                  }
                ]
              },
              {
                controlType: "div",
                style: {
                  width: "100%",
                  height: 100,
                  marginTop: 64
                },
                children: [
                  {
                    controlType: "Avatar",
                    properties: {
                      elevation: 12,
                      src: "/webapp/res/avatar.png"
                    },
                    style: {
                      width: 84,
                      height: 84,
                      position: "absolute",
                      left: "50%",
                      transform: "translate(-50%, 0)"
                    }
                  }
                ]
              },
              {
                controlType: "div",
                style: {
                  width: "100%"
                },
                children: [
                  {
                    controlType: "Typography",
                    style: {
                      width: "100%",
                      textAlign: "center",
                      color: "white"
                    },
                    children: [
                      {
                        controlType: "Text",
                        text: "کیهان محمدی"
                      }
                    ]
                  },
                  {
                    controlType: "Typography",
                    style: {
                      width: "100%",
                      textAlign: "center",
                      color: "white"
                    },
                    children: [
                      {
                        controlType: "Text",
                        text: "22 ساله"
                      }
                    ]
                  },
                  {
                    controlType: "Typography",
                    style: {
                      width: "100%",
                      textAlign: "center",
                      color: "white"
                    },
                    children: [
                      {
                        controlType: "Text",
                        text: "مشتری"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            controlType: "div",
            style: {
              height: 256
            }
          },
          {
            controlType: "div",
            properties: {
              animation: "${profileHistListAnim}",
              animationTime: "${profileHistListAnimTime}"
            },
            style: {
              width: "100%",
              backgroundColor: "#fff"
            },
            children: [
              {
                controlType: "Grid",
                style: {
                  backgroundColor: "#fff",
                  paddingTop: 16,
                  marginLeft: 16,
                  marginRight: 16
                },
                properties: {
                  item: true,
                  xs: 12,
                  md: 6
                },
                children: [
                  {
                    controlType: "Typography",
                    properties: {
                      variant: "h6",
                      marginLeft: 16
                    },
                    children: [
                      {
                        controlType: "Text",
                        text: "سوابق مراجعه کننده"
                      }
                    ]
                  },
                  {
                    controlType: "div",
                    children: [
                      {
                        controlType: "List",
                        children: [
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem,
                          histItem
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      })